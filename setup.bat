@echo off
chcp 65001 >nul
echo üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ Clinici.md...

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Node.js
node --version >nul 2>&1
if errorlevel 1 (
    echo ‚ùå Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js 18+
    pause
    exit /b 1
)

echo ‚úÖ Node.js –Ω–∞–π–¥–µ–Ω

REM –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
call npm install

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è .env —Ñ–∞–π–ª–∞
if not exist .env (
    echo ‚ö†Ô∏è  –§–∞–π–ª .env –Ω–µ –Ω–∞–π–¥–µ–Ω
    echo üìù –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:
    echo.
    echo DATABASE_URL="postgresql://username:password@localhost:5432/clinici_db"
    echo PORT=5000
    echo NODE_ENV=development
    echo.
    echo üîó –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Neon (neon.tech) –¥–ª—è –æ–±–ª–∞—á–Ω–æ–π PostgreSQL
    echo.
    set /p continue="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–µ–∑ .env? (y/n): "
    if /i not "%continue%"=="y" exit /b 1
) else (
    echo ‚úÖ –§–∞–π–ª .env –Ω–∞–π–¥–µ–Ω
)

REM –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö...
call npm run db:push >nul 2>&1
if errorlevel 1 (
    echo ‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    echo üìã –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
    echo    - PostgreSQL –∑–∞–ø—É—â–µ–Ω
    echo    - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞
    echo    - DATABASE_URL –≤ .env —Ñ–∞–π–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
    echo.
    echo üîó –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Neon (neon.tech) –¥–ª—è –æ–±–ª–∞—á–Ω–æ–π PostgreSQL
    pause
    exit /b 1
) else (
    echo ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ
    
    REM –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    echo üå± –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏...
    call npx tsx server/seed.ts
    
    echo.
    echo üéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
    echo üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –∫–æ–º–∞–Ω–¥–æ–π: npm run dev
    echo üåê –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:5000
)

pause
