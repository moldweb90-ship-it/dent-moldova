# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–∞—Ç–∞:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∞ –≤ –∞–¥–º–∏–Ω–∫–µ –ù–ï –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ Service Worker

---

## üêõ **–í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

### 1. Service Worker –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î, –Ω–æ SW –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ
- –ù–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è SW –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

### 2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è `staleWhileRevalidate` –≤—ã–∑—ã–≤–∞–µ—Ç —Å–±—Ä–æ—Å —Ñ–æ—Ä–º
- SW –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–µ—à –≤ —Ñ–æ–Ω–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ö
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü

---

## ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

### 1. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Service Worker**
**–§–∞–π–ª:** `client/src/administrator/components/Settings.tsx`

```typescript
// –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï Service Worker
if ('serviceWorker' in navigator) {
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
  if (navigator.serviceWorker.controller) {
    navigator.serviceWorker.controller.postMessage({
      type: 'UPDATE_SETTINGS',
      settings: data
    });
  }
  
  // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º Service Worker
  const registration = await navigator.serviceWorker.getRegistration();
  if (registration && registration.waiting) {
    registration.waiting.postMessage({ type: 'SKIP_WAITING' });
  }
  
  // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
  setTimeout(() => {
    window.location.reload();
  }, 1000);
}
```

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Service Worker**
**–§–∞–π–ª:** `public/sw.js`

```javascript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –∞–¥–º–∏–Ω–∫–∏
self.addEventListener('message', (event) => {
  if (event.data && event.data.type === 'UPDATE_SETTINGS') {
    console.log('Service Worker: –ü–æ–ª—É—á–µ–Ω—ã –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏', event.data.settings);
    cacheSettings = { ...cacheSettings, ...event.data.settings };
    
    // –û—á–∏—â–∞–µ–º –∫–µ—à –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    caches.keys().then((cacheNames) => {
      return Promise.all(
        cacheNames.map((cacheName) => {
          console.log('Service Worker: –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞', cacheName);
          return caches.delete(cacheName);
        })
      );
    });
  }
  
  if (event.data && event.data.type === 'SKIP_WAITING') {
    self.skipWaiting();
  }
});
```

### 3. **Network First —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü**
**–§–∞–π–ª:** `public/sw.js`

```javascript
// Network First —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
if (cacheSettings.cacheStrategy === 'networkFirst') {
  try {
    const networkResponse = await fetch(request);
    if (networkResponse.ok) {
      // –ö–µ—à–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –¥–ª—è fallback
      const responseToCache = networkResponse.clone();
      const headers = new Headers(responseToCache.headers);
      headers.set('sw-cache-date', new Date().toISOString());
      
      const modifiedResponse = new Response(responseToCache.body, {
        status: responseToCache.status,
        statusText: responseToCache.statusText,
        headers: headers
      });
      
      await cache.put(request, modifiedResponse);
      return networkResponse; // –í–°–ï–ì–î–ê –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ
    }
  } catch (error) {
    // –ï—Å–ª–∏ —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à
    if (cachedResponse) {
      return cachedResponse;
    }
  }
}
```

---

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

### **–î–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–±—Ä–æ—Å–æ–º —Ñ–æ—Ä–º:**

1. **–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - ‚úÖ **–í–∫–ª—é—á–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –í–ö–õ–Æ–ß–ï–ù–û
   - üìä **–°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** - **"Network First"**

2. **–°—Ç—Ä–∞–Ω–∏—Ü—ã (HTML):**
   - ‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã** - –í–ö–õ–Æ–ß–ï–ù–û
   - ‚è±Ô∏è **–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è** - **1 –º–∏–Ω—É—Ç–∞**
   - üîß **–°—Ç—Ä–∞—Ç–µ–≥–∏—è** - **"Network First"**

3. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã:**
   - ‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å** - –í–ö–õ–Æ–ß–ï–ù–û
   - ‚è±Ô∏è **–°—Ä–æ–∫** - **30 –¥–Ω–µ–π**
   - üîß **–°—Ç—Ä–∞—Ç–µ–≥–∏—è** - **"Cache First"**

4. **API –¥–∞–Ω–Ω—ã–µ:**
   - ‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å** - –í–ö–õ–Æ–ß–ï–ù–û
   - ‚è±Ô∏è **–°—Ä–æ–∫** - **15 –º–∏–Ω—É—Ç**
   - üîß **–°—Ç—Ä–∞—Ç–µ–≥–∏—è** - **"Stale While Revalidate"**

---

## üöÄ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ**
- ‚úÖ **–§–æ—Ä–º—ã –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è** (Network First –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü)
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** (Cache First –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏)
- ‚úÖ **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (Stale While Revalidate –¥–ª—è API)
- ‚úÖ **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SW** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

## üìã **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é:**

1. **–°–æ—Ö—Ä–∞–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ —Ñ–∞–π–ª–∞—Ö
2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä** (`npm run dev`)
3. **–ó–∞–π–¥–∏ –≤ –∞–¥–º–∏–Ω–∫—É** ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **–£—Å—Ç–∞–Ω–æ–≤–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - –°—Ç—Ä–∞—Ç–µ–≥–∏—è: **"Network First"**
   - –°—Ç—Ä–∞–Ω–∏—Ü—ã: **"Network First"** + **1 –º–∏–Ω—É—Ç–∞**
   - –°—Ç–∞—Ç–∏–∫–∞: **"Cache First"** + **30 –¥–Ω–µ–π**
5. **–ù–∞–∂–º–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"** - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
6. **–ü—Ä–æ–≤–µ—Ä—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ** - —Ñ–æ—Ä–º—ã –±–æ–ª—å—à–µ –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è

**–ì–æ—Ç–æ–≤–æ!** üéâ
