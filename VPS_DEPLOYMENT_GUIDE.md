# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ VPS

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
# –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤ package.json –Ω–µ—Ç:
# - @google-cloud/storage
# - @uppy/* –ø–∞–∫–µ—Ç—ã
# - passport, passport-local
# - openid-client
# - google-auth-library
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª
```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π DATABASE_URL –¥–ª—è production
DATABASE_URL=postgresql://username:password@ep-raspy-cloud-XXXXX.eu-central-1.aws.neon.tech/neondb?sslmode=require
ADMIN_PASSWORD=–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å_–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
SESSION_SECRET=—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞
NODE_ENV=production
PORT=5000
```

## üñ•Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh root@5.35.126.5
cd /var/www/clinici.md
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
rm -rf node_modules package-lock.json

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–Ω–æ–≤–æ
npm install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞
```bash
# –û—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç—ã
ufw allow 80
ufw allow 5000
ufw status
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

### 1. –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
nano /etc/nginx/sites-available/clinici-md
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
```nginx
server {
    listen 80;
    server_name 5.35.126.5;

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–ª–∏–Ω–∏–∫
    location /images/ {
        alias /var/www/clinici.md/img/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    location / {
        proxy_pass http://[::1]:5000;  # IPv6 localhost
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### 3. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–∞–π—Ç
```bash
ln -s /etc/nginx/sites-available/clinici-md /etc/nginx/sites-enabled/
nginx -t
systemctl reload nginx
```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1. –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 stop all
pm2 delete all

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ dev —Ä–µ–∂–∏–º–µ
pm2 start npm --name "clinici-md" -- run dev

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status
pm2 logs clinici-md
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
```bash
pm2 save
pm2 startup
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç
netstat -tlnp | grep :5000

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
curl http://localhost:5000
```

### 2. –í–Ω–µ—à–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å –≤–Ω–µ—à–Ω–µ–≥–æ IP
curl http://5.35.126.5
```

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–±–æ—Ä–∫–æ–π
- **–ü—Ä–æ–±–ª–µ–º–∞:** `Error: Dynamic require of "fs" is not supported`
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å dev —Ä–µ–∂–∏–º –≤–º–µ—Å—Ç–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 2. –ü—Ä–æ–±–ª–µ–º–∞ —Å IPv4/IPv6
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ IPv6, Nginx –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ IPv4
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `proxy_pass http://[::1]:5000` –≤ Nginx

### 3. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- **–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ä—ã–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã
- **–†–µ—à–µ–Ω–∏–µ:** –û—á–∏—Å—Ç–∏—Ç—å package.json –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π

### 4. –ü—Ä–æ–±–ª–µ–º–∞ —Å dotenv
- **–ü—Ä–æ–±–ª–µ–º–∞:** `Cannot find module 'dotenv'`
- **–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞—Ç—å —Ñ–ª–∞–≥ `--packages=external` –∏–∑ —Å–±–æ—Ä–∫–∏

### 5. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∫–ª–∏–Ω–∏–∫
- **–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–æ—Ç–∏–ø—ã –∫–ª–∏–Ω–∏–∫ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç `/images/` –≤ Nginx –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (–∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/images/`)
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `location /images/ { alias /var/www/clinici.md/img/; }`
- **–í–∞–∂–Ω–æ:** –ü—É—Ç—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `/images/`, –∞ –Ω–µ `/img/`, —Ç–∞–∫ –∫–∞–∫ –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–∂–∏–¥–∞–µ—Ç `/images/`

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –°—Ç–∞—Ç—É—Å PM2
pm2 status

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs clinici-md

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
netstat -tlnp | grep :5000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx
nginx -t
systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞
ufw status
```

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- **–†–µ–∂–∏–º:** Development (—Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- **–ü–æ—Ä—Ç:** 5000 (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ) + 80 (Nginx)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL Neon
- **–ü—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä:** PM2
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä:** Nginx (reverse proxy)

## üîÑ –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ SFTP
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å `npm install` (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å: `pm2 restart clinici-md`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: `pm2 logs clinici-md`

## üñºÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
```
/var/www/clinici.md/
‚îú‚îÄ‚îÄ img/                    # –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∫–ª–∏–Ω–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ clinic-logo-*.jpg   # –õ–æ–≥–æ—Ç–∏–ø—ã –∫–ª–∏–Ω–∏–∫
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ ...
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–∞–ø–∫–∞ img —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la /var/www/clinici.md/img/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo -u www-data ls /var/www/clinici.md/img/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
curl http://5.35.126.5/images/clinic-logo-1755701483875-827367833.jpg
```

### 3. –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart clinici-md

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
systemctl reload nginx

# –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à PM2
pm2 flush clinici-md
```

---
**–°–æ–∑–¥–∞–Ω–æ:** 27.08.2025  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 27.08.2025
