# ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ "–û—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—á–∞—Å"

**–î–∞—Ç–∞:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–≤–∏—Å–∞–Ω–∏—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ñ–∏–ª—å—Ç—Ä–∞ "–û—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—á–∞—Å"

---

## üêõ –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ò–∑–±—ã—Ç–æ—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
if (window.queryClient) {
  window.queryClient.invalidateQueries({ queryKey: ['/api/clinics'] });
  window.queryClient.removeQueries({ queryKey: ['/api/clinics'] });
}
```
- –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `openNow`
- **2 –æ–ø–µ—Ä–∞—Ü–∏–∏** –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è React Query

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
// –£–±—Ä–∞–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é - React Query —Å–∞–º –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ queryKey
```

---

### 2. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Å—á–µ—Ç—ã `buildQueryParams`
**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
const buildQueryParams = useCallback(() => {
  // ...
}, [searchQuery, filters, page, language, isOpenNowActive]);
```
- `useCallback` —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ `filters` ‚Üí –Ω–æ–≤—ã–π queryKey ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
const queryParams = useMemo(() => {
  // ...
  return params.toString();
}, [searchQuery, filters, page, language, isOpenNowActive]);

const queryKey = useMemo(() => 
  ['/api/clinics', queryParams, language], 
  [queryParams, language]
);
```
- `useMemo` –≤–º–µ—Å—Ç–æ `useCallback` –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- –ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π queryKey

---

### 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ state updates
**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
navigateToOpenNow(...);  // 1. –ò–∑–º–µ–Ω–µ–Ω–∏–µ URL ‚Üí —Ä–µ-—Ä–µ–Ω–¥–µ—Ä
setFilters(newFilters);  // 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚Üí —Ä–µ-—Ä–µ–Ω–¥–µ—Ä
setPage(1);              // 3. –°–±—Ä–æ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Üí —Ä–µ-—Ä–µ–Ω–¥–µ—Ä
```
- **3 —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∞** –ø—Ä–∏ –æ–¥–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- React –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞—Ç—á–∏—Ç state updates –≤ event handlers
- –í—Å–µ 3 –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ü–∏–∫–ª–µ

---

### 4. –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ useEffect
**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
useEffect(() => {
  if (isOpenNowActive) {
    setFilters(prev => {
      if (!prev.openNow) {
        return { ...prev, openNow: true };
      }
      return prev;
    });
  }
}, [isOpenNowActive]);
```
- –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `isOpenNowActive`
- –ù–µ—Ç —Å–±—Ä–æ—Å–∞ –ø—Ä–∏ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
useEffect(() => {
  if (isOpenNowActive && !filters.openNow) {
    setFilters(prev => ({ ...prev, openNow: true }));
  } else if (!isOpenNowActive && filters.openNow) {
    setFilters(prev => ({ ...prev, openNow: undefined }));
  }
}, [isOpenNowActive]);
```
- –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å

---

### 5. –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π useEffect –¥–ª—è URL —Ñ–∏–ª—å—Ç—Ä–æ–≤
**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
useEffect(() => {
  // –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–ª –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤
  setFilters(prev => ({
    ...prev,
    city: selectedCity.id,
    // ...
  }));
}, [citySlug, districtSlug, cities, districts, language, activeFeatures, isManualFilterChange]);
```
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ state –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Üí —á–∞—Å—Ç—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```typescript
useEffect(() => {
  if (!cities.length) return;
  
  setFilters(prev => {
    // –í—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    const newDistrictIds = ...;
    const newFeatures = ...;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
    if (prev.city === selectedCity.id && 
        JSON.stringify(prev.districts) === JSON.stringify(newDistrictIds) &&
        JSON.stringify(prev.features) === JSON.stringify(newFeatures)) {
      return prev; // –ù–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç
    }
    
    return { ...prev, city: selectedCity.id, ... };
  });
}, [citySlug, districtSlug, cities, districts, language, activeFeatures, isManualFilterChange]);
```
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π **–ø–µ—Ä–µ–¥** —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
- –†–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –î–æ
- **2-3 –∑–∞–ø—Ä–æ—Å–∞** –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–û—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—á–∞—Å"
- –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- 3+ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∞
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Å—á–µ—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ü–æ—Å–ª–µ
- **1 –∑–∞–ø—Ä–æ—Å** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º —á–µ—Ä–µ–∑ React Query
- –ë–∞—Ç—á–∏–Ω–≥ state updates
- –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ useEffect

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### React Query –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```typescript
staleTime: 30 * 1000,        // –ö–µ—à –Ω–∞ 30 —Å–µ–∫—É–Ω–¥
gcTime: 2 * 60 * 1000,       // –•—Ä–∞–Ω–µ–Ω–∏–µ 2 –º–∏–Ω—É—Ç—ã
refetchOnWindowFocus: false, // –ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
refetchOnMount: false,       // –ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
```

### –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–æ–≤
1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `if (!prev.openNow)` –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
2. ‚úÖ –í–æ–∑–≤—Ä–∞—Ç —Ç–æ–≥–æ –∂–µ –æ–±—ä–µ–∫—Ç–∞ –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
3. ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ `useMemo`
4. ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ useEffect

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|--------|-----------|
| API –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –∫–ª–∏–∫–µ | 2-3 | 1 | **67%** ‚¨áÔ∏è |
| –†–µ-—Ä–µ–Ω–¥–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ | 3+ | 1 | **67%** ‚¨áÔ∏è |
| –û—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞ | 2 | 0 | **100%** ‚¨áÔ∏è |
| –ü–µ—Ä–µ—Å—á–µ—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | 3-5 | 1 | **80%** ‚¨áÔ∏è |

---

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç 1: –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞
1. –û—Ç–∫—Ä—ã—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. –ù–∞–∂–∞—Ç—å "–û—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—á–∞—Å" –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö
3. ‚úÖ URL –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `/open-now`
4. ‚úÖ –°–ø–∏—Å–æ–∫ –∫–ª–∏–Ω–∏–∫ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è
5. ‚úÖ –¢–æ–ª—å–∫–æ 1 –∑–∞–ø—Ä–æ—Å –≤ Network

### –¢–µ—Å—Ç 2: –í—ã–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞
1. –°–Ω—è—Ç—å –≥–∞–ª–æ—á–∫—É "–û—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—á–∞—Å"
2. ‚úÖ URL –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ `/`
3. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –∫–ª–∏–Ω–∏–∫–∏
4. ‚úÖ –¢–æ–ª—å–∫–æ 1 –∑–∞–ø—Ä–æ—Å

### –¢–µ—Å—Ç 3: –° –≥–æ—Ä–æ–¥–æ–º
1. –í—ã–±—Ä–∞—Ç—å –≥–æ—Ä–æ–¥ ‚Üí –≤—ã–±—Ä–∞—Ç—å "–û—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ–π—á–∞—Å"
2. ‚úÖ URL: `/city/chisinau/open-now`
3. ‚úÖ –§–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –∫–ª–∏–Ω–∏–∫–∏ –≥–æ—Ä–æ–¥–∞
4. ‚úÖ –ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `client/src/pages/Home.tsx` - –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–°—Ç—Ä–æ–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- 186-193: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è useEffect –¥–ª—è openNow
- 228-283: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è useEffect –¥–ª—è URL —Ñ–∏–ª—å—Ç—Ä–æ–≤
- 273-303: –ó–∞–º–µ–Ω–∞ useCallback –Ω–∞ useMemo –¥–ª—è queryParams
- 305-328: –ú–µ–º–æ–∏–∑–∞—Ü–∏—è queryKey –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ React Query
- 571-590: –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å** `filters.openNow` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ useEffect
2. **–í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è—Ç—å** –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ `setFilters`
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** `useMemo` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, `useCallback` –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
4. **–î–æ–≤–µ—Ä—è—Ç—å** React Query —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º
5. **React 18** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞—Ç—á–∏—Ç updates –≤ event handlers

---

## üöÄ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. ‚ú® Debounce –¥–ª—è –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ `useDebounce`)
2. ‚ú® Virtual scrolling –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∫–ª–∏–Ω–∏–∫
3. ‚ú® Prefetching —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
4. ‚ú® Service Worker –¥–ª—è offline –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
5. ‚ú® React.memo –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:** ‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ production

