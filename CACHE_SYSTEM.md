# Система кеширования изображений

## Обзор
Реализована многоуровневая система кеширования изображений для устранения серых блоков при обновлении страницы и улучшения производительности.

## Компоненты системы

### 1. ImageCache (`client/src/utils/imageCache.ts`)
- **Память**: Кеш в оперативной памяти (50MB, 100 записей)
- **localStorage**: Долгосрочное хранение (60 минут)
- **Автоочистка**: Каждые 5 минут удаляются истекшие записи
- **Статистика**: Отслеживание попаданий/промахов, размера кеша

### 2. LazyImage (`client/src/components/LazyImage.tsx`)
- **Lazy loading**: Загрузка только при появлении в viewport
- **Приоритетная загрузка**: Для первых изображений (priority=true)
- **Fallback**: Автоматическое переключение на резервное изображение
- **Skeleton**: Показ placeholder во время загрузки

### 3. LazyClinicCard (`client/src/components/LazyClinicCard.tsx`)
- **Lazy loading карточек**: Загрузка только видимых карточек
- **Приоритет**: Первые 6 карточек загружаются с приоритетом

### 4. CacheMonitor (`client/src/components/CacheMonitor.tsx`)
- **Мониторинг**: Отображение статистики кеша в режиме разработки
- **Управление**: Кнопка очистки кеша

## Настройки кеширования

```typescript
// Основные параметры
MAX_MEMORY_SIZE = 50MB        // Максимальный размер в памяти
MAX_ENTRIES = 100             // Максимальное количество записей
CACHE_DURATION = 60 минут     // Время жизни записи
CLEANUP_INTERVAL = 5 минут    // Интервал автоочистки
```

## Преимущества

✅ **Устранение серых блоков**: Изображения загружаются мгновенно из кеша
✅ **Улучшенная производительность**: Снижение количества HTTP-запросов
✅ **Умная предзагрузка**: Первые 6 карточек загружаются с приоритетом
✅ **Автоматическое управление**: Очистка истекших записей
✅ **Fallback система**: Резервные изображения при ошибках
✅ **Статистика**: Мониторинг эффективности кеша

## Использование

### Приоритетная загрузка
```tsx
<LazyImage 
  src="/path/to/image.jpg" 
  alt="Description"
  priority={true} // Загружается сразу
/>
```

### Обычная загрузка
```tsx
<LazyImage 
  src="/path/to/image.jpg" 
  alt="Description"
  fallbackSrc="/fallback.jpg" // Резервное изображение
/>
```

### Мониторинг кеша
```tsx
<CacheMonitor show={true} />
```

## Результат
- При обновлении страницы изображения загружаются мгновенно из кеша
- Нет серых блоков при повторных посещениях
- Улучшенная производительность и пользовательский опыт
- Автоматическое управление памятью и очистка































